<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
<meta content="yes" name="apple-mobile-web-app-capable">
<meta content="black" name="apple-mobile-web-app-status-bar-style">
<meta content="telephone=no" name="format-detection">
<meta content="no-cache" http-equiv="Cache-Control">
<title>上品折扣微商城</title>
<link href="css/shopin.css" rel="stylesheet"/>
</head>

<body>
<div class="header">
	<div class="left"><a href="javascript:;" class="a-back"><span>返回</span></a></div>
	<div class="center">
		<h1>购物车</h1>
	</div>
</div><!--//头部结束-->

<div class="content">
	<div class="cart-main">
		<div class="cart-list">
			<div class="cart-shop">
				<div class="cart-title">首体店到店自提</div>
				<div class="cart-edit"><a href="javascript:;" class="btn btn-default cartEdit">编辑</a></div>
			</div>
			<div class="cart-box">
				<div class="cart-group">
					<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox setSelectAll" checked></div>
					<div class="cart-item">
						<div class="small">
							<div class="p"><a href="product.html"><img src="images/img/p6-small.jpg"></a></div>
							<div class="d">
								<a href="product.html"><h3 class="d-title clamp">卡雷尔2015秋季新品女装商城同款九分袖连衣裙淑女花色针织连衣裙</h3></a>
								<div class="d-main">
									<div class="sub">
										<span class="price">
											<span class="s">￥<em class="n">198</em>.00</span><del>吊牌价￥1499.00</del>
										</span>
									</div>
									<div class="opt">
										<div class="number"><button type="button" class="decrease">-</button><input type="number" class="num" value="1" min="1" max="库存" name="quantity"><button type="button" class="increase">+</button></div>
										<i class="icon-del"></i>
									</div>
								</div>
							</div>
						</div><!-- //单品结束 -->
					</div>
				</div><!-- /商品结束 -->
				<div class="cart-group">
					<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox setSelectAll" checked></div>
					<div class="cart-item">
						<div class="small">
							<div class="p"><a href="product.html"><img src="images/img/p6-small.jpg"></a></div>
							<div class="d">
								<a href="product.html"><h3 class="d-title clamp">卡雷尔2015秋季新品女装商城同款九分袖连衣裙淑女花色针织连衣裙</h3></a>
								<div class="d-main">
									<div class="sub">
										<span class="price">
											<span class="s">￥<em class="n">198</em>.00</span><del>吊牌价￥1499.00</del>
										</span>
									</div>
									<div class="opt">
										<div class="number"><button type="button" class="decrease">-</button><input type="number" class="num" value="1" min="1" max="库存" name="quantity"><button type="button" class="increase">+</button></div>
										<i class="icon-del"></i>
									</div>
								</div>
							</div>
						</div><!-- //单品结束 -->
					</div>
				</div><!-- /商品结束 -->
				<div class="cart-group">
					<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox setSelectAll" checked></div>
					<div class="cart-item">
						<div class="small">
							<div class="p"><a href="product.html"><img src="images/img/p6-small.jpg"></a></div>
							<div class="d">
								<a href="product.html"><h3 class="d-title clamp">卡雷尔2015秋季新品女装商城同款九分袖连衣裙淑女花色针织连衣裙</h3></a>
								<div class="d-main">
									<div class="sub">
										<span class="price">
											<span class="s">￥<em class="n">198</em>.00</span><del>吊牌价￥1499.00</del>
										</span>
									</div>
									<div class="opt">
										<div class="number"><button type="button" class="decrease">-</button><input type="number" class="num" value="1" min="1" max="库存" name="quantity"><button type="button" class="increase">+</button></div>
										<i class="icon-del"></i>
									</div>
								</div>
							</div>
						</div><!-- //单品结束 -->
					</div>
				</div><!-- /商品结束 -->
			</div>
			<div class="cart-group cart-footer">
				<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox selectAll" checked></div>
				<div class="cart-item">
					<a class="btn btn-pay" href="payment.html">结算</a>
					<div class="price">总计：<b>￥198.00</b></div>
					<div class="quantity">共<b>1</b>件商品</div>
				</div>
			</div>
		</div><!-- //门店结算结束 -->
		<div class="cart-list">
			<div class="cart-shop">
				<div class="cart-title">中关村店到店自提</div>
				<div class="cart-edit"><a href="javascript:;" class="btn btn-default cartEdit">编辑</a></div>
			</div>
			<div class="cart-box">
				<div class="cart-group">
					<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox setSelectAll" checked></div>
					<div class="cart-item">
						<div class="small">
							<div class="p"><a href="product.html"><img src="images/img/p6-small.jpg"></a></div>
							<div class="d">
								<a href="product.html"><h3 class="d-title clamp">卡雷尔2015秋季新品女装商城同款九分袖连衣裙淑女花色针织连衣裙</h3></a>
								<div class="d-main">
									<div class="sub">
										<span class="price">
											<span class="s">￥<em class="n">198</em>.00</span><del>吊牌价￥1499.00</del>
										</span>
									</div>
									<div class="opt">
										<div class="number"><button type="button" class="decrease">-</button><input type="number" class="num" value="1" min="1" max="库存" name="quantity"><button type="button" class="increase">+</button></div>
										<i class="icon-del"></i>
									</div>
								</div>
							</div>
						</div><!-- //单品结束 -->
					</div>
				</div><!-- /商品结束 -->
				<div class="cart-group">
					<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox setSelectAll" checked></div>
					<div class="cart-item">
						<div class="small">
							<div class="p"><a href="product.html"><img src="images/img/p6-small.jpg"></a></div>
							<div class="d">
								<a href="product.html"><h3 class="d-title clamp">卡雷尔2015秋季新品女装商城同款九分袖连衣裙淑女花色针织连衣裙</h3></a>
								<div class="d-main">
									<div class="sub">
										<span class="price">
											<span class="s">￥<em class="n">198</em>.00</span><del>吊牌价￥1499.00</del>
										</span>
									</div>
									<div class="opt">
										<div class="number"><button type="button" class="decrease">-</button><input type="number" class="num" value="1" min="1" max="库存" name="quantity"><button type="button" class="increase">+</button></div>
										<i class="icon-del"></i>
									</div>
								</div>
							</div>
						</div><!-- //单品结束 -->
					</div>
				</div><!-- /商品结束 -->
				<div class="cart-group">
					<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox setSelectAll" checked></div>
					<div class="cart-item">
						<div class="small">
							<div class="p"><a href="product.html"><img src="images/img/p6-small.jpg"></a></div>
							<div class="d">
								<a href="product.html"><h3 class="d-title clamp">卡雷尔2015秋季新品女装商城同款九分袖连衣裙淑女花色针织连衣裙</h3></a>
								<div class="d-main">
									<div class="sub">
										<span class="price">
											<span class="s">￥<em class="n">198</em>.00</span><del>吊牌价￥1499.00</del>
										</span>
									</div>
									<div class="opt">
										<div class="number"><button type="button" class="decrease">-</button><input type="number" class="num" value="1" min="1" max="库存" name="quantity"><button type="button" class="increase">+</button></div>
										<i class="icon-del"></i>
									</div>
								</div>
							</div>
						</div><!-- //单品结束 -->
					</div>
				</div><!-- /商品结束 -->
			</div>
			<div class="cart-group cart-footer">
				<div class="cart-icb"><input type="checkbox" name="shop" class="icon-checkbox selectAll" checked></div>
				<div class="cart-item">
					<a class="btn btn-pay" href="payment.html">结算</a>
					<div class="price">总计：<b>￥198.00</b></div>
					<div class="quantity">共<b>1</b>件商品</div>
				</div>
			</div>
		</div><!-- //门店结算结束 -->
	</div>
</div>
<div class="empty">
	<div class="empty-pic cry-pic"></div>
	<div class="empty-text">您的购物车中空空如也，快去购物吧！</div>
	<div class="empty-btn"><a href="index.html" class="btn">去逛逛</a></div>
</div>
<script src="js/zepto.min.js"></script>
<script src="js/shopin.js"></script>
<script>
$('.cartEdit').on('tap', function() {
	if($(this).text() == '编辑'){
		$(this).text('确定').parents('.cart-list').addClass('editOrder');
		$(this).parents('.cart-list').find('a').click(function(event) {
			event.preventDefault();
		});
	}else{
		$(this).text('编辑').parents('.cart-list').removeClass('editOrder');
		$(this).parents('.cart-list').find('a').unbind('click');
	}
});
//全选
$('.selectAll').on('change', 'input', function() {
	var $this = $(this).closest('.cart-list');
	var obj = $this.find('.setSelectAll');
	var value = this.checked;
	if(value == false) {
		for(var i=0; i<obj.length; i++) {
			obj[i].checked=false;
		}
	}else{
		for(var i=0; i<obj.length; i++){
			obj[i].checked=true;
		}
	}
});

$('.setSelectAll').on('change', 'input', function() {
	var $this = $(this).closest('.cart-list');
	var obj = $this.find('.setSelectAll');
	var count = obj.length;
	var selectCount = 0;
	for(var i = 0; i < count; i++) {
		if(obj[i].checked == true){
			selectCount++;
		}
	}
	if(count == selectCount) {
		$this.find('.selectAll').prop('checked',true);
	}else{
		$this.find('.selectAll').prop('checked',false);
	}
});

//调整购买数量
var increase,decrease,num,numTxt;
increase = $(".increase");
decrease = $(".decrease");
num = "";
increase.on('tap', function() {
	numTxt = $(this).closest(".number").find(".num");
	num = numTxt.val();
	num++;
	numTxt.val(num);
	//ajax代码可以放这里传递到数据库实时改变总价
});
decrease.on('tap', function() {
	numTxt = $(this).closest(".number").find(".num");
	num = numTxt.val();
	if(num >0){
		if(num==1){
			num--;
			alert('购买数量不能为0')
		} else {
			num--;
			numTxt.val(num);
		}
	}
});

//删除
$('.icon-del').on('tap', function() {
	var a = $(this).closest(".cart-list");
	var len = a.find('.cart-box .cart-group').length;
	if( len <= 1){
		$(this).closest(".cart-list").remove();
	}else{
		$(this).closest(".cart-group").remove();
	}
	var cartList = $('.cart-list').length;
	if(cartList == 0){
		$('.cart-main').css('display','block');
		$('.empty').css('display','block');
	}
});
</script>
</body>
</html>